type TCryptoAlgorithm = 'md5' | 'sha224' | 'sha256' | 'sha384' | 'sha512' | 'sha3-224' | 'sha3-256' | 'sha3-384' | 'sha3-512'

@mongo.collection 'users'
public interface User {
    @label 'User "ID"'
    @mongo.key 'string'
    _id: string

    @label "Email"
    @mongo.uniqueIndex "email"
    @mongo.textIndex
    @description "Unique user email"
    id: string    

    @label "User Name (public)"
    @mongo.uniqueIndex "userid"
    @mongo.textIndex
    @description "Unique ID that can be used for login"
    username: string

    t2: string

    password: {
        @label "Password Hash"
        hash: string

        @label "Password Salt"
        salt: string

        @label "Encryption Algorithm"
        algorithm: TCryptoAlgorithm

        history: {
            @label "Encryption Algorithm"
            algorithm: TCryptoAlgorithm

            @label "Password Hash"
            hash: string            
        }[]

        @label "Last Changed"
        lastChanged: number

        @label "Is Initial"
        isInitial: boolean        
    }
  
    account: {
        @label "Is user active?"
        active: boolean

        @label "Is Locked"
        locked: boolean

        @label "Lock Reason"
        lockReason: string

        @label "Lock End Timestamp"
        lockEnds: number

        @label "Failed Login Attempts"
        failedLoginAttempts: number

        @label "Last Login"
        lastLogin: number        
    }
  
    mfa: {
        email: {
            @label "Email Address"
            address: string

            @label "Email Confirmed"
            confirmed: boolean            
        }

        sms: {
            @label "Phone Confirmed"
            confirmed: boolean

            @label "Phone Number"
            number: string            
        }

        @label "Default Method"
        default: '' | 'sms' | 'email' | 'totp'

        @label "Enable Auto-send"
        autoSend: boolean        
    }

    @label "First Name"
    @mongo.textIndex
    firstName?: string
  
    @label "Last Name"
    @mongo.textIndex
    lastName?: string
  
    @label "Assigned Dealers"
    dealers: string[]
  
    @label "Assigned Roles"
    roles: string[]
}
